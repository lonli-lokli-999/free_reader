const emblem={template:'<div class="emblem"><div class="spine"></div><div class="bookmark"></div></div>'},book_area={props:["content"],template:'\n\t<div class="book" @scroll="updateReadingStatus" >\n\t\t<div v-html="content"></div>\n\t\t<div class="set-page-btns">\n\t\t\t<button class="set-page-btn" @click="pageUp"><span class="fa fa-angle-double-up"></span></button>\n\t\t\t<button class="set-page-btn" @click="pageDown"><span class="fa fa-angle-double-down"></span></button>\n\t\t</div>\n\t</div>\n\t',methods:{updateReadingStatus(){let t=document.querySelector(".book"),o=t.scrollHeight,e=Math.floor(o/t.clientHeight),a=Math.ceil(t.scrollTop/t.clientHeight);a=0==a?1:a;let s=`${a}/${e}`,n=t.scrollTop/o*100;this.$emit("changedReadingStatus",{procent:n,pages:s})},pageUp(){let t=this.$el;t.scrollTop-=t.clientHeight},pageDown(){let t=this.$el;t.scrollTop+=t.clientHeight}}},tab_bar={props:["chapters","cover","book_name"],data:function(){return{bookmards:null}},mounted(){localStorage.bookmarks&&this.book_name&&(this.bookmards=JSON.parse(localStorage.bookmarks).filter(t=>t.book_name==this.book_name))},methods:{tabBarToggle(){document.querySelector(".tab-bar").classList.toggle("tab-bar--active"),document.querySelector(".tab-bar__toggle-btn").classList.toggle("tab-bar__toggle-btn--active")},viewCover(){let t=document.createElement("div");t.classList.add("img-full-screen-view"),t.appendChild(document.querySelector(".js-cover").cloneNode()),t.addEventListener("click",(function(){this.remove()})),document.body.appendChild(t)},bookmarksUpdate(){localStorage.bookmarks&&this.book_name&&(this.bookmards=JSON.parse(localStorage.bookmarks).filter(t=>t.book_name==this.book_name))},showTheTab(t){this.$el.querySelector(".tab--active").classList.remove("tab--active");let o=t.target.id?t.target.id:t.target.parentElement.id;this.$el.querySelector("."+o).classList.add("tab--active"),"bookmards"==o&&this.bookmarksUpdate()},goToBookmarks(t){let o=t.target.getAttribute("data-process"),e=document.querySelector(".book");e.scrollTop=e.scrollHeight/100*o},deleteBookmark(t){let o=JSON.parse(localStorage.bookmarks),e=t.target.getAttribute("data-bookmarks-id")?t.target:t.target.parentElement,a=e.getAttribute("data-bookmarks-id");o=o.filter(t=>t.id!=a),localStorage.bookmarks=JSON.stringify(o),e.closest(".bookmark-link").remove()}},template:'\n\t\t<div class="tab-bar-wrap">\n\t\t\t<button class="tab-bar__toggle-btn" @click="tabBarToggle">\n\t\t\t\t<span class="fa fa-angle-double-down toggle-btn__icon"></span>\n\t\t\t</button>\n\t\t\t<div class="tab-bar">\n\t\t\t\t<header class="tab-bar__header">\n\t\t\t\t\t<button class="tab-bar__header-btn options-btn" @click="tabBarToggle">\n\t\t\t\t\t\t<span class="fa fa-close"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="options-btn" @click="showTheTab" id="links">\n\t\t\t\t\t\t<span class="fa fa-list"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="options-btn" @click="showTheTab" id="bookmards">\n\t\t\t\t\t\t<span class="fa fa-bookmark"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="options-btn" @click="showTheTab" id="book_info">\n\t\t\t\t\t\t<span class="fa fa-info"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</header>\n\t\t\t\t<div class="tab tab--active links">\n\t\t\t\t\t<a v-for="link in chapters" :href="link.href" class="tab-bar__btn">{{link.label}}</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="tab bookmards">\n\t\t\t\t\t<div v-for="link in bookmards" class="bookmark-link">\n\t\t\t\t\t\t<button  :data-process="link.process" @click="goToBookmarks" class="tab-bar__btn">{{link.name}}</button>\n\t\t\t\t\t\t<button class="bookmark-del" :data-bookmarks-id="link.id" @click="deleteBookmark"><span class="fa fa-minus"></span></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="tab book_info">\n\t\t\t\t\t<img class="js-cover" v-if="cover" :src="cover" @click="viewCover">\n\t\t\t\t\t<h2 class="book-name">{{ book_name }}</h2>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t'};export const main={props:["book"],data:function(){return{chapters:null}},template:'\n\t\t<main class="main-content-wrap" >\n\t\t\t<div class="main-content conatiner">\n\t\t\t\t<div v-if="book" is="tab_bar" :cover="book.cover" :chapters="chapters" :book_name="book.title"></div>\n\t\t\t\t<div v-if="book" is="book_area" :content="book.content" @changedReadingStatus="updateReadingStatus"></div>\n\t\t\t\t<div v-if="!book" is="emblem"></div>\n\t\t\t</div>\n\t\t</main>\n\t',components:{book_area:book_area,emblem:emblem,tab_bar:tab_bar},methods:{updateReadingStatus(t){let o=this.books_progress.findIndex(t=>t.name==this.book.title);-1!=o?this.books_progress[o].progress=t:this.books_progress.push({name:this.book.title,progress:t}),localStorage.books_progress=JSON.stringify(this.books_progress),this.$emit("changedReadingStatus",t)}},computed:{books_progress:function(){return localStorage.books_progress?JSON.parse(localStorage.books_progress):[]},the_progress:function(){let t=this.books_progress.find(t=>t.name==this.book.title);return!!t&&t.progress}},watch:{book(){let t=[];setTimeout(()=>{let o=document.querySelector(".book");this.$el.querySelectorAll("h2").forEach((o,e)=>{o.id="chapter_"+e,t.push({label:o.innerText,href:"#chapter_"+e})}),o.scrollTop=this.the_progress?o.scrollHeight/100*this.the_progress.procent:0,this.chapters=t},2e3)}}};